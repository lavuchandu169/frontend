{"ast":null,"code":"import React,{useEffect,useState}from\"react\";import{useDispatch,useSelector}from\"react-redux\";import DOMPurify from\"dompurify\";import{useNavigate}from\"react-router-dom\";import{setLoginUser}from\"../redux/loginSlice\";import FormInput from\"./FormInput\";import Button from\"./Button\";import\"./Login.css\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Login=()=>{const dispatch=useDispatch();const[errors,setErrors]=useState({});const[username,setUserName]=useState(\"\");const[password,setPassword]=useState(\"\");const[message,setMessage]=useState(\"\");const[passwordVisible,setPasswordVisible]=useState(false);const navigate=useNavigate();useEffect(()=>{fetch(\"https://backend-7ksj.onrender.com/verifyUser\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify({user:localStorage.getItem(\"user\")})}).then(res=>{if(res.status===200){res.json().then(res=>{dispatch(setLoginUser(res.userId));let goToDashBoard=()=>navigate(\"/dashboard\");goToDashBoard();});}}).catch(err=>{console.log(err.message);// alert(err.message);\n});},[]);const validate=()=>{const errors={};if(!username.trim()){errors.username=\"Username is required\";}if(!password){errors.password=\"Password is required\";}return errors;};const handleSubmit=async e=>{e.preventDefault();const validationErrors=validate();if(Object.keys(validationErrors).length>0){setErrors(validationErrors);return;}try{fetch(\"https://backend-7ksj.onrender.com/login\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify({username:username,password:password})}).then(res=>{if(res.status===200){res.json().then(res=>{localStorage.setItem(\"user\",res.user);setMessage(\"Login successful!\");dispatch(setLoginUser(username));let goToDashBoard=()=>navigate(\"/dashboard\");goToDashBoard();});}else{res.json(res=>{setMessage(\"Login failed: \".concat(res.message));});}});}catch(error){setMessage(\"Login failed: \".concat(error.message));}};return/*#__PURE__*/_jsxs(\"div\",{className:\"login\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Login\"}),message&&/*#__PURE__*/_jsx(\"p\",{children:message}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(FormInput,{type:\"text\",name:\"username\",label:\"Username\",value:username,onChange:e=>{setUserName(e.target.value);},error:errors.username}),/*#__PURE__*/_jsx(FormInput,{type:passwordVisible?\"text\":\"password\",name:\"password\",label:\"Password\",value:password,onChange:e=>{setPassword(e.target.value);},error:errors.password,toggleVisibility:()=>setPasswordVisible(!passwordVisible),isPassword:true}),/*#__PURE__*/_jsx(Button,{type:\"submit\",label:\"Login\"})]})]});};export default Login;","map":{"version":3,"names":["React","useEffect","useState","useDispatch","useSelector","DOMPurify","useNavigate","setLoginUser","FormInput","Button","jsx","_jsx","jsxs","_jsxs","Login","dispatch","errors","setErrors","username","setUserName","password","setPassword","message","setMessage","passwordVisible","setPasswordVisible","navigate","fetch","method","headers","body","JSON","stringify","user","localStorage","getItem","then","res","status","json","userId","goToDashBoard","catch","err","console","log","validate","trim","handleSubmit","e","preventDefault","validationErrors","Object","keys","length","setItem","concat","error","className","children","onSubmit","type","name","label","value","onChange","target","toggleVisibility","isPassword"],"sources":["/workspaces/frontend/src/components/Login.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport DOMPurify from \"dompurify\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport { setLoginUser } from \"../redux/loginSlice\";\r\nimport FormInput from \"./FormInput\";\r\nimport Button from \"./Button\";\r\nimport \"./Login.css\";\r\n\r\nconst Login = () => {\r\n  const dispatch = useDispatch();\r\n  const [errors, setErrors] = useState({});\r\n  const [username, setUserName] = useState(\"\");\r\n  const [password, setPassword] = useState(\"\");\r\n  const [message, setMessage] = useState(\"\");\r\n  const [passwordVisible, setPasswordVisible] = useState(false);\r\n  const navigate = useNavigate();\r\n\r\n  useEffect(() => {\r\n    fetch(\"https://backend-7ksj.onrender.com/verifyUser\", {\r\n      method: \"POST\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n      body: JSON.stringify({ user: localStorage.getItem(\"user\") }),\r\n    })\r\n      .then((res) => {\r\n        if (res.status === 200) {\r\n          res.json().then((res) => {\r\n            dispatch(setLoginUser(res.userId));\r\n            let goToDashBoard = () => navigate(\"/dashboard\");\r\n            goToDashBoard();\r\n          });\r\n        }\r\n      })\r\n      .catch((err) => {\r\n        console.log(err.message);\r\n        // alert(err.message);\r\n      });\r\n  }, []);\r\n\r\n  const validate = () => {\r\n    const errors = {};\r\n    if (!username.trim()) {\r\n      errors.username = \"Username is required\";\r\n    }\r\n    if (!password) {\r\n      errors.password = \"Password is required\";\r\n    }\r\n    return errors;\r\n  };\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    const validationErrors = validate();\r\n    if (Object.keys(validationErrors).length > 0) {\r\n      setErrors(validationErrors);\r\n      return;\r\n    }\r\n    try {\r\n      fetch(\"https://backend-7ksj.onrender.com/login\", {\r\n        method: \"POST\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n        body: JSON.stringify({\r\n          username: username,\r\n          password: password,\r\n        }),\r\n      }).then((res) => {\r\n        if (res.status === 200) {\r\n          res.json().then((res) => {\r\n            localStorage.setItem(\"user\", res.user);\r\n            setMessage(\"Login successful!\");\r\n            dispatch(setLoginUser(username));\r\n            let goToDashBoard = () => navigate(\"/dashboard\");\r\n            goToDashBoard();\r\n          });\r\n        } else {\r\n          res.json((res) => {\r\n            setMessage(`Login failed: ${res.message}`);\r\n          });\r\n        }\r\n      });\r\n    } catch (error) {\r\n      setMessage(`Login failed: ${error.message}`);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"login\">\r\n      <h2>Login</h2>\r\n      {message && <p>{message}</p>}\r\n      <form onSubmit={handleSubmit}>\r\n        <FormInput\r\n          type=\"text\"\r\n          name=\"username\"\r\n          label=\"Username\"\r\n          value={username}\r\n          onChange={(e) => {\r\n            setUserName(e.target.value);\r\n          }}\r\n          error={errors.username}\r\n        />\r\n        <FormInput\r\n          type={passwordVisible ? \"text\" : \"password\"}\r\n          name=\"password\"\r\n          label=\"Password\"\r\n          value={password}\r\n          onChange={(e) => {\r\n            setPassword(e.target.value);\r\n          }}\r\n          error={errors.password}\r\n          toggleVisibility={() => setPasswordVisible(!passwordVisible)}\r\n          isPassword\r\n        />\r\n        <Button type=\"submit\" label=\"Login\" />\r\n      </form>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Login;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}