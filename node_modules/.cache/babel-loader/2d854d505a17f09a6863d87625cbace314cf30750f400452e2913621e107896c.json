{"ast":null,"code":"import React,{useEffect,useState}from\"react\";import{useDispatch,useSelector}from\"react-redux\";import DOMPurify from\"dompurify\";import{setFormData,resetForm}from\"../redux/registerSlice\";import FormInput from\"./FormInput\";import{useNavigate}from\"react-router-dom\";import Button from\"./Button\";import\"./Register.css\";import{setLoginUser}from\"../redux/loginSlice\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Register=()=>{const dispatch=useDispatch();const formData=useSelector(state=>state.register);const navigate=useNavigate();const[errors,setErrors]=useState({});const[message,setMessage]=useState(\"\");const[passwordVisible,setPasswordVisible]=useState(false);const[confirmPasswordVisible,setConfirmPasswordVisible]=useState(false);useEffect(()=>{fetch(\"https://backend-7ksj.onrender.com/verifyUser\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify({user:localStorage.getItem(\"user\")})}).then(res=>{if(res.status===200){res.json().then(res=>{dispatch(setLoginUser(res.userId));let goToDashBoard=()=>navigate(\"/dashboard\");goToDashBoard();});}}).catch(err=>{// alert(err.message);\n});},[]);const handleChange=e=>{const sanitizedValue=DOMPurify.sanitize(e.target.value);dispatch(setFormData({name:e.target.name,value:sanitizedValue}));};const validate=()=>{const errors={};if(!formData.username.trim()){errors.username=\"Username is required\";}if(!formData.password){errors.password=\"Password is required\";}else if(formData.password.length<6){errors.password=\"Password must be at least 6 characters\";}if(formData.password!==formData.confirmPassword){errors.confirmPassword=\"Passwords do not match\";}return errors;};const handleSubmit=async e=>{e.preventDefault();const validationErrors=validate();if(Object.keys(validationErrors).length>0){setErrors(validationErrors);return;}try{const response=await fetch(\"https://backend-7ksj.onrender.com/register\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\",\"X-Requested-With\":\"XMLHttpRequest\"},body:JSON.stringify({username:formData.username,password:formData.password,confirmPassword:formData.confirmPassword})});const data=await response.json();if(response.ok){setMessage(\"Registration successful!\");dispatch(resetForm());}else{setMessage(\"Registration failed: \".concat(data.message));}}catch(error){setMessage(\"Registration failed: \".concat(error.message));}};return/*#__PURE__*/_jsxs(\"div\",{className:\"register\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Register\"}),message&&/*#__PURE__*/_jsx(\"p\",{children:message}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(FormInput,{type:\"text\",name:\"username\",label:\"Username\",value:formData.username,onChange:handleChange,error:errors.username}),/*#__PURE__*/_jsx(FormInput,{type:passwordVisible?\"text\":\"password\",name:\"password\",label:\"Password\",value:formData.password,onChange:handleChange,error:errors.password,toggleVisibility:()=>setPasswordVisible(!passwordVisible),isPassword:true}),/*#__PURE__*/_jsx(FormInput,{type:confirmPasswordVisible?\"text\":\"password\",name:\"confirmPassword\",label:\"Confirm Password\",value:formData.confirmPassword,onChange:handleChange,error:errors.confirmPassword,toggleVisibility:()=>setConfirmPasswordVisible(!confirmPasswordVisible),isPassword:true}),/*#__PURE__*/_jsx(Button,{type:\"submit\",label:\"Register\"})]})]});};export default Register;","map":{"version":3,"names":["React","useEffect","useState","useDispatch","useSelector","DOMPurify","setFormData","resetForm","FormInput","useNavigate","Button","setLoginUser","jsx","_jsx","jsxs","_jsxs","Register","dispatch","formData","state","register","navigate","errors","setErrors","message","setMessage","passwordVisible","setPasswordVisible","confirmPasswordVisible","setConfirmPasswordVisible","fetch","method","headers","body","JSON","stringify","user","localStorage","getItem","then","res","status","json","userId","goToDashBoard","catch","err","handleChange","e","sanitizedValue","sanitize","target","value","name","validate","username","trim","password","length","confirmPassword","handleSubmit","preventDefault","validationErrors","Object","keys","response","data","ok","concat","error","className","children","onSubmit","type","label","onChange","toggleVisibility","isPassword"],"sources":["/workspaces/frontend/src/components/Register.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport DOMPurify from \"dompurify\";\r\nimport { setFormData, resetForm } from \"../redux/registerSlice\";\r\nimport FormInput from \"./FormInput\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport Button from \"./Button\";\r\nimport \"./Register.css\";\r\nimport { setLoginUser } from \"../redux/loginSlice\";\r\n\r\nconst Register = () => {\r\n  const dispatch = useDispatch();\r\n  const formData = useSelector((state) => state.register);\r\n  const navigate = useNavigate();\r\n  const [errors, setErrors] = useState({});\r\n  const [message, setMessage] = useState(\"\");\r\n  const [passwordVisible, setPasswordVisible] = useState(false);\r\n  const [confirmPasswordVisible, setConfirmPasswordVisible] = useState(false);\r\n\r\n  useEffect(() => {\r\n    fetch(\"https://backend-7ksj.onrender.com/verifyUser\", {\r\n      method: \"POST\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n      body: JSON.stringify({ user: localStorage.getItem(\"user\") }),\r\n    })\r\n      .then((res) => {\r\n        if (res.status === 200) {\r\n          res.json().then((res) => {\r\n            dispatch(setLoginUser(res.userId));\r\n            let goToDashBoard = () => navigate(\"/dashboard\");\r\n            goToDashBoard();\r\n          });\r\n        }\r\n      })\r\n      .catch((err) => {\r\n        // alert(err.message);\r\n      });\r\n  }, []);\r\n\r\n  const handleChange = (e) => {\r\n    const sanitizedValue = DOMPurify.sanitize(e.target.value);\r\n    dispatch(setFormData({ name: e.target.name, value: sanitizedValue }));\r\n  };\r\n\r\n  const validate = () => {\r\n    const errors = {};\r\n    if (!formData.username.trim()) {\r\n      errors.username = \"Username is required\";\r\n    }\r\n    if (!formData.password) {\r\n      errors.password = \"Password is required\";\r\n    } else if (formData.password.length < 6) {\r\n      errors.password = \"Password must be at least 6 characters\";\r\n    }\r\n    if (formData.password !== formData.confirmPassword) {\r\n      errors.confirmPassword = \"Passwords do not match\";\r\n    }\r\n    return errors;\r\n  };\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    const validationErrors = validate();\r\n    if (Object.keys(validationErrors).length > 0) {\r\n      setErrors(validationErrors);\r\n      return;\r\n    }\r\n    try {\r\n      const response = await fetch(\"https://backend-7ksj.onrender.com/register\", {\r\n        method: \"POST\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n          \"X-Requested-With\": \"XMLHttpRequest\",\r\n        },\r\n        body: JSON.stringify({\r\n          username: formData.username,\r\n          password: formData.password,\r\n          confirmPassword: formData.confirmPassword,\r\n        }),\r\n      });\r\n      const data = await response.json();\r\n      if (response.ok) {\r\n        setMessage(\"Registration successful!\");\r\n        dispatch(resetForm());\r\n      } else {\r\n        setMessage(`Registration failed: ${data.message}`);\r\n      }\r\n    } catch (error) {\r\n      setMessage(`Registration failed: ${error.message}`);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"register\">\r\n      <h2>Register</h2>\r\n      {message && <p>{message}</p>}\r\n      <form onSubmit={handleSubmit}>\r\n        <FormInput\r\n          type=\"text\"\r\n          name=\"username\"\r\n          label=\"Username\"\r\n          value={formData.username}\r\n          onChange={handleChange}\r\n          error={errors.username}\r\n        />\r\n        <FormInput\r\n          type={passwordVisible ? \"text\" : \"password\"}\r\n          name=\"password\"\r\n          label=\"Password\"\r\n          value={formData.password}\r\n          onChange={handleChange}\r\n          error={errors.password}\r\n          toggleVisibility={() => setPasswordVisible(!passwordVisible)}\r\n          isPassword\r\n        />\r\n        <FormInput\r\n          type={confirmPasswordVisible ? \"text\" : \"password\"}\r\n          name=\"confirmPassword\"\r\n          label=\"Confirm Password\"\r\n          value={formData.confirmPassword}\r\n          onChange={handleChange}\r\n          error={errors.confirmPassword}\r\n          toggleVisibility={() =>\r\n            setConfirmPasswordVisible(!confirmPasswordVisible)\r\n          }\r\n          isPassword\r\n        />\r\n        <Button type=\"submit\" label=\"Register\" />\r\n      </form>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Register;\r\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,SAAS,CAAEC,QAAQ,KAAQ,OAAO,CAClD,OAASC,WAAW,CAAEC,WAAW,KAAQ,aAAa,CACtD,MAAO,CAAAC,SAAS,KAAM,WAAW,CACjC,OAASC,WAAW,CAAEC,SAAS,KAAQ,wBAAwB,CAC/D,MAAO,CAAAC,SAAS,KAAM,aAAa,CACnC,OAASC,WAAW,KAAQ,kBAAkB,CAC9C,MAAO,CAAAC,MAAM,KAAM,UAAU,CAC7B,MAAO,gBAAgB,CACvB,OAASC,YAAY,KAAQ,qBAAqB,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAEnD,KAAM,CAAAC,QAAQ,CAAGA,CAAA,GAAM,CACrB,KAAM,CAAAC,QAAQ,CAAGd,WAAW,CAAC,CAAC,CAC9B,KAAM,CAAAe,QAAQ,CAAGd,WAAW,CAAEe,KAAK,EAAKA,KAAK,CAACC,QAAQ,CAAC,CACvD,KAAM,CAAAC,QAAQ,CAAGZ,WAAW,CAAC,CAAC,CAC9B,KAAM,CAACa,MAAM,CAAEC,SAAS,CAAC,CAAGrB,QAAQ,CAAC,CAAC,CAAC,CAAC,CACxC,KAAM,CAACsB,OAAO,CAAEC,UAAU,CAAC,CAAGvB,QAAQ,CAAC,EAAE,CAAC,CAC1C,KAAM,CAACwB,eAAe,CAAEC,kBAAkB,CAAC,CAAGzB,QAAQ,CAAC,KAAK,CAAC,CAC7D,KAAM,CAAC0B,sBAAsB,CAAEC,yBAAyB,CAAC,CAAG3B,QAAQ,CAAC,KAAK,CAAC,CAE3ED,SAAS,CAAC,IAAM,CACd6B,KAAK,CAAC,8CAA8C,CAAE,CACpDC,MAAM,CAAE,MAAM,CACdC,OAAO,CAAE,CACP,cAAc,CAAE,kBAClB,CAAC,CACDC,IAAI,CAAEC,IAAI,CAACC,SAAS,CAAC,CAAEC,IAAI,CAAEC,YAAY,CAACC,OAAO,CAAC,MAAM,CAAE,CAAC,CAC7D,CAAC,CAAC,CACCC,IAAI,CAAEC,GAAG,EAAK,CACb,GAAIA,GAAG,CAACC,MAAM,GAAK,GAAG,CAAE,CACtBD,GAAG,CAACE,IAAI,CAAC,CAAC,CAACH,IAAI,CAAEC,GAAG,EAAK,CACvBvB,QAAQ,CAACN,YAAY,CAAC6B,GAAG,CAACG,MAAM,CAAC,CAAC,CAClC,GAAI,CAAAC,aAAa,CAAGA,CAAA,GAAMvB,QAAQ,CAAC,YAAY,CAAC,CAChDuB,aAAa,CAAC,CAAC,CACjB,CAAC,CAAC,CACJ,CACF,CAAC,CAAC,CACDC,KAAK,CAAEC,GAAG,EAAK,CACd;AAAA,CACD,CAAC,CACN,CAAC,CAAE,EAAE,CAAC,CAEN,KAAM,CAAAC,YAAY,CAAIC,CAAC,EAAK,CAC1B,KAAM,CAAAC,cAAc,CAAG5C,SAAS,CAAC6C,QAAQ,CAACF,CAAC,CAACG,MAAM,CAACC,KAAK,CAAC,CACzDnC,QAAQ,CAACX,WAAW,CAAC,CAAE+C,IAAI,CAAEL,CAAC,CAACG,MAAM,CAACE,IAAI,CAAED,KAAK,CAAEH,cAAe,CAAC,CAAC,CAAC,CACvE,CAAC,CAED,KAAM,CAAAK,QAAQ,CAAGA,CAAA,GAAM,CACrB,KAAM,CAAAhC,MAAM,CAAG,CAAC,CAAC,CACjB,GAAI,CAACJ,QAAQ,CAACqC,QAAQ,CAACC,IAAI,CAAC,CAAC,CAAE,CAC7BlC,MAAM,CAACiC,QAAQ,CAAG,sBAAsB,CAC1C,CACA,GAAI,CAACrC,QAAQ,CAACuC,QAAQ,CAAE,CACtBnC,MAAM,CAACmC,QAAQ,CAAG,sBAAsB,CAC1C,CAAC,IAAM,IAAIvC,QAAQ,CAACuC,QAAQ,CAACC,MAAM,CAAG,CAAC,CAAE,CACvCpC,MAAM,CAACmC,QAAQ,CAAG,wCAAwC,CAC5D,CACA,GAAIvC,QAAQ,CAACuC,QAAQ,GAAKvC,QAAQ,CAACyC,eAAe,CAAE,CAClDrC,MAAM,CAACqC,eAAe,CAAG,wBAAwB,CACnD,CACA,MAAO,CAAArC,MAAM,CACf,CAAC,CAED,KAAM,CAAAsC,YAAY,CAAG,KAAO,CAAAZ,CAAC,EAAK,CAChCA,CAAC,CAACa,cAAc,CAAC,CAAC,CAClB,KAAM,CAAAC,gBAAgB,CAAGR,QAAQ,CAAC,CAAC,CACnC,GAAIS,MAAM,CAACC,IAAI,CAACF,gBAAgB,CAAC,CAACJ,MAAM,CAAG,CAAC,CAAE,CAC5CnC,SAAS,CAACuC,gBAAgB,CAAC,CAC3B,OACF,CACA,GAAI,CACF,KAAM,CAAAG,QAAQ,CAAG,KAAM,CAAAnC,KAAK,CAAC,4CAA4C,CAAE,CACzEC,MAAM,CAAE,MAAM,CACdC,OAAO,CAAE,CACP,cAAc,CAAE,kBAAkB,CAClC,kBAAkB,CAAE,gBACtB,CAAC,CACDC,IAAI,CAAEC,IAAI,CAACC,SAAS,CAAC,CACnBoB,QAAQ,CAAErC,QAAQ,CAACqC,QAAQ,CAC3BE,QAAQ,CAAEvC,QAAQ,CAACuC,QAAQ,CAC3BE,eAAe,CAAEzC,QAAQ,CAACyC,eAC5B,CAAC,CACH,CAAC,CAAC,CACF,KAAM,CAAAO,IAAI,CAAG,KAAM,CAAAD,QAAQ,CAACvB,IAAI,CAAC,CAAC,CAClC,GAAIuB,QAAQ,CAACE,EAAE,CAAE,CACf1C,UAAU,CAAC,0BAA0B,CAAC,CACtCR,QAAQ,CAACV,SAAS,CAAC,CAAC,CAAC,CACvB,CAAC,IAAM,CACLkB,UAAU,yBAAA2C,MAAA,CAAyBF,IAAI,CAAC1C,OAAO,CAAE,CAAC,CACpD,CACF,CAAE,MAAO6C,KAAK,CAAE,CACd5C,UAAU,yBAAA2C,MAAA,CAAyBC,KAAK,CAAC7C,OAAO,CAAE,CAAC,CACrD,CACF,CAAC,CAED,mBACET,KAAA,QAAKuD,SAAS,CAAC,UAAU,CAAAC,QAAA,eACvB1D,IAAA,OAAA0D,QAAA,CAAI,UAAQ,CAAI,CAAC,CAChB/C,OAAO,eAAIX,IAAA,MAAA0D,QAAA,CAAI/C,OAAO,CAAI,CAAC,cAC5BT,KAAA,SAAMyD,QAAQ,CAAEZ,YAAa,CAAAW,QAAA,eAC3B1D,IAAA,CAACL,SAAS,EACRiE,IAAI,CAAC,MAAM,CACXpB,IAAI,CAAC,UAAU,CACfqB,KAAK,CAAC,UAAU,CAChBtB,KAAK,CAAElC,QAAQ,CAACqC,QAAS,CACzBoB,QAAQ,CAAE5B,YAAa,CACvBsB,KAAK,CAAE/C,MAAM,CAACiC,QAAS,CACxB,CAAC,cACF1C,IAAA,CAACL,SAAS,EACRiE,IAAI,CAAE/C,eAAe,CAAG,MAAM,CAAG,UAAW,CAC5C2B,IAAI,CAAC,UAAU,CACfqB,KAAK,CAAC,UAAU,CAChBtB,KAAK,CAAElC,QAAQ,CAACuC,QAAS,CACzBkB,QAAQ,CAAE5B,YAAa,CACvBsB,KAAK,CAAE/C,MAAM,CAACmC,QAAS,CACvBmB,gBAAgB,CAAEA,CAAA,GAAMjD,kBAAkB,CAAC,CAACD,eAAe,CAAE,CAC7DmD,UAAU,MACX,CAAC,cACFhE,IAAA,CAACL,SAAS,EACRiE,IAAI,CAAE7C,sBAAsB,CAAG,MAAM,CAAG,UAAW,CACnDyB,IAAI,CAAC,iBAAiB,CACtBqB,KAAK,CAAC,kBAAkB,CACxBtB,KAAK,CAAElC,QAAQ,CAACyC,eAAgB,CAChCgB,QAAQ,CAAE5B,YAAa,CACvBsB,KAAK,CAAE/C,MAAM,CAACqC,eAAgB,CAC9BiB,gBAAgB,CAAEA,CAAA,GAChB/C,yBAAyB,CAAC,CAACD,sBAAsB,CAClD,CACDiD,UAAU,MACX,CAAC,cACFhE,IAAA,CAACH,MAAM,EAAC+D,IAAI,CAAC,QAAQ,CAACC,KAAK,CAAC,UAAU,CAAE,CAAC,EACrC,CAAC,EACJ,CAAC,CAEV,CAAC,CAED,cAAe,CAAA1D,QAAQ","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}