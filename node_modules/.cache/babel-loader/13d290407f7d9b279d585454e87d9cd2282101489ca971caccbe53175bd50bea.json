{"ast":null,"code":"import React,{useEffect}from\"react\";import{useDispatch,useSelector}from\"react-redux\";import{useNavigate}from\"react-router-dom\";import{setSharedDocuments,setCurrentDocument}from\"../redux/documentsSlice\";import\"./SharedDocuments.css\";import{setLoginUser}from\"../redux/loginSlice\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const SharedDocuments=()=>{const dispatch=useDispatch();const navigate=useNavigate();const currentUser=useSelector(state=>state.login.loginUser);const sharedDocuments=useSelector(state=>state.documents.sharedDocuments);useEffect(()=>{fetch(\"https://backend-7ksj.onrender.com/verifyUser\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify({user:localStorage.getItem(\"user\")})}).then(res=>{if(res.status===200){res.json().then(res=>{dispatch(setLoginUser(res.userId));fetch(\"https://backend-7ksj.onrender.com/getSharedDocuments\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify({userId:res.userId})}).then(res=>{if(res.status===200){res.json().then(res=>{let fetchedSharedDocuments=[...res.filesList];let l=[];for(var i=0;i<fetchedSharedDocuments.length;i++){let su=[];for(var j=0;j<fetchedSharedDocuments[i].sharedUsers.length;j++){let obj={...fetchedSharedDocuments[i].sharedUsers[j]};su.push({userId:obj.userId,permissions:obj.permission.split(\",\")});}fetchedSharedDocuments[i].sharedUsers=[...su];fetchedSharedDocuments[i].permissions=fetchedSharedDocuments[i].permissions.split(\",\");l.push(fetchedSharedDocuments[i]);}dispatch(setSharedDocuments(l));});}else{res.json().then(res=>{alert(res.message);});}}).catch(err=>{alert(\"Failed to fetch documents due to : \\n\"+err.message);});});}else{let goToLogin=()=>dispatch(\"/login\");goToLogin();dispatch(setLoginUser(\"\"));}}).catch(err=>{alert(err.message);});},[dispatch]);const handleViewClick=doc=>{dispatch(setCurrentDocument(doc));navigate(\"/dashboard/view-document/\".concat(doc.fileId));};const handleEditClick=doc=>{dispatch(setCurrentDocument(doc));navigate(\"/dashboard/edit-document/\".concat(doc.fileId));};return/*#__PURE__*/_jsxs(\"div\",{className:\"shared-documents\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Shared Documents\"}),sharedDocuments.length===0?/*#__PURE__*/_jsx(\"p\",{children:\"No Shared Documents\"}):/*#__PURE__*/_jsxs(\"table\",{className:\"w-full\",children:[/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"File Name\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Owner\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Permissions\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Actions\"})]}),sharedDocuments.map(doc=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:doc.fileName}),/*#__PURE__*/_jsx(\"td\",{children:doc.ownerName}),/*#__PURE__*/_jsx(\"td\",{children:doc.permissions.join(\", \")}),/*#__PURE__*/_jsxs(\"td\",{className:\"flex justify-center items-center gap-2\",children:[doc.permissions.includes(\"view\")&&/*#__PURE__*/_jsx(\"button\",{className:\"icon-button\",title:\"View\",onClick:()=>handleViewClick(doc),children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-eye\"})}),doc.permissions.includes(\"edit\")&&/*#__PURE__*/_jsx(\"button\",{className:\"icon-button\",title:\"Edit\",onClick:()=>handleEditClick(doc),children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-edit\"})})]})]}))]})]});};export default SharedDocuments;","map":{"version":3,"names":["React","useEffect","useDispatch","useSelector","useNavigate","setSharedDocuments","setCurrentDocument","setLoginUser","jsx","_jsx","jsxs","_jsxs","SharedDocuments","dispatch","navigate","currentUser","state","login","loginUser","sharedDocuments","documents","fetch","method","headers","body","JSON","stringify","user","localStorage","getItem","then","res","status","json","userId","fetchedSharedDocuments","filesList","l","i","length","su","j","sharedUsers","obj","push","permissions","permission","split","alert","message","catch","err","goToLogin","handleViewClick","doc","concat","fileId","handleEditClick","className","children","map","fileName","ownerName","join","includes","title","onClick"],"sources":["/workspaces/frontend/src/components/SharedDocuments.js"],"sourcesContent":["import React, { useEffect } from \"react\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport {\r\n  setSharedDocuments,\r\n  setCurrentDocument,\r\n} from \"../redux/documentsSlice\";\r\nimport \"./SharedDocuments.css\";\r\nimport { setLoginUser } from \"../redux/loginSlice\";\r\n\r\nconst SharedDocuments = () => {\r\n  const dispatch = useDispatch();\r\n  const navigate = useNavigate();\r\n  const currentUser = useSelector((state) => state.login.loginUser);\r\n  const sharedDocuments = useSelector(\r\n    (state) => state.documents.sharedDocuments\r\n  );\r\n\r\n  useEffect(() => {\r\n    fetch(\"https://backend-7ksj.onrender.com/verifyUser\", {\r\n      method: \"POST\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n      body: JSON.stringify({ user: localStorage.getItem(\"user\") }),\r\n    })\r\n      .then((res) => {\r\n        if (res.status === 200) {\r\n          res.json().then((res) => {\r\n            dispatch(setLoginUser(res.userId));\r\n            fetch(\"https://backend-7ksj.onrender.com/getSharedDocuments\", {\r\n              method: \"POST\",\r\n              headers: {\r\n                \"Content-Type\": \"application/json\",\r\n              },\r\n              body: JSON.stringify({ userId: res.userId }),\r\n            })\r\n              .then((res) => {\r\n                if (res.status === 200) {\r\n                  res.json().then((res) => {\r\n                    let fetchedSharedDocuments = [...res.filesList];\r\n                    let l = [];\r\n                    for (var i = 0; i < fetchedSharedDocuments.length; i++) {\r\n                      let su = [];\r\n                      for (\r\n                        var j = 0;\r\n                        j < fetchedSharedDocuments[i].sharedUsers.length;\r\n                        j++\r\n                      ) {\r\n                        let obj = {\r\n                          ...fetchedSharedDocuments[i].sharedUsers[j],\r\n                        };\r\n                        su.push({\r\n                          userId: obj.userId,\r\n                          permissions: obj.permission.split(\",\"),\r\n                        });\r\n                      }\r\n                      fetchedSharedDocuments[i].sharedUsers = [...su];\r\n                      fetchedSharedDocuments[i].permissions =\r\n                        fetchedSharedDocuments[i].permissions.split(\",\");\r\n                      l.push(fetchedSharedDocuments[i]);\r\n                    }\r\n                    dispatch(setSharedDocuments(l));\r\n                  });\r\n                } else {\r\n                  res.json().then((res) => {\r\n                    alert(res.message);\r\n                  });\r\n                }\r\n              })\r\n              .catch((err) => {\r\n                alert(\"Failed to fetch documents due to : \\n\" + err.message);\r\n              });\r\n          });\r\n        } else {\r\n          let goToLogin = () => dispatch(\"/login\");\r\n          goToLogin();\r\n          dispatch(setLoginUser(\"\"));\r\n        }\r\n      })\r\n      .catch((err) => {\r\n        alert(err.message);\r\n      });\r\n  }, [dispatch]);\r\n\r\n  const handleViewClick = (doc) => {\r\n    dispatch(setCurrentDocument(doc));\r\n    navigate(`/dashboard/view-document/${doc.fileId}`);\r\n  };\r\n\r\n  const handleEditClick = (doc) => {\r\n    dispatch(setCurrentDocument(doc));\r\n    navigate(`/dashboard/edit-document/${doc.fileId}`);\r\n  };\r\n\r\n  return (\r\n    <div className=\"shared-documents\">\r\n      <h2>Shared Documents</h2>\r\n      {sharedDocuments.length === 0 ? (\r\n        <p>No Shared Documents</p>\r\n      ) : (\r\n        <table className=\"w-full\">\r\n          <tr>\r\n            <th>File Name</th>\r\n            <th>Owner</th>\r\n            <th>Permissions</th>\r\n            <th>Actions</th>\r\n          </tr>\r\n          {sharedDocuments.map((doc) => (\r\n            <tr>\r\n              <td>{doc.fileName}</td>\r\n              <td>{doc.ownerName}</td>\r\n              <td>{doc.permissions.join(\", \")}</td>\r\n              <td className=\"flex justify-center items-center gap-2\">\r\n                {doc.permissions.includes(\"view\") && (\r\n                  <button\r\n                    className=\"icon-button\"\r\n                    title=\"View\"\r\n                    onClick={() => handleViewClick(doc)}\r\n                  >\r\n                    <i className=\"fas fa-eye\"></i>\r\n                  </button>\r\n                )}\r\n                {doc.permissions.includes(\"edit\") && (\r\n                  <button\r\n                    className=\"icon-button\"\r\n                    title=\"Edit\"\r\n                    onClick={() => handleEditClick(doc)}\r\n                  >\r\n                    <i className=\"fas fa-edit\"></i>\r\n                  </button>\r\n                )}\r\n              </td>\r\n            </tr>\r\n          ))}\r\n        </table>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default SharedDocuments;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}